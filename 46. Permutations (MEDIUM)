class Solution {
public:
    vector<vector<int>> permute(vector<int>& nums) {
        vector<int>v{1,2,6,24,120,720};
        int n=nums.size();
        sort(nums.begin(),nums.end());
        vector<vector<int>>ans;
        ans.push_back(nums);
        for(int i=1;i<v[n-1];i++)
        {
            vector<int>s=ans[i-1];
            int k;
            for(int j=n-1;j>0;j--)
            {
                if(s[j-1]<s[j])
                {
                    k=j;
                    break;
                }
            }
            int ind=k,mx=INT_MAX;
            for(int l=k;l<n;l++)
            {
                if(mx>=s[l]-s[k-1]&&s[l]>s[k-1])
                {
                    ind=l;
                    mx=s[l]-s[k-1];
                }
            }
            swap(s[k-1],s[ind]);
            reverse(s.begin()+k,s.end());
            ans.push_back(s);
        }
        return ans;
    }
};

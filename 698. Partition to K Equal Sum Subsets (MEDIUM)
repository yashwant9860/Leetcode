class Solution
{
public:
    bool backtrack(int i, const vector<int> &nums, int cur_sum, const int &target, int k, vector<bool> &visited)
    {
        if (k == 1)
            return true;
        if (cur_sum == target)
            return backtrack(0, nums, 0, target, k - 1, visited);

        for (int j = i; j < nums.size(); j++)
        {
            if (!visited[j] && cur_sum + nums[j] <= target)
            {
                visited[j] = true;
                if (backtrack(j + 1, nums, cur_sum + nums[j], target, k, visited))
                    return true;
                visited[j] = false;
                if (cur_sum == 0)
                    break;
            }
        }
        return false;
    }
    bool canPartitionKSubsets(vector<int> &nums, int k)
    {
        int sum = accumulate(nums.begin(), nums.end(), 0);
        if (sum % k != 0 || nums.size() < k)
            return false;

        vector<bool> visited(nums.size(), false);
        return backtrack(0, nums, 0, sum / k, k, visited);
    }
};
